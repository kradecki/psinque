{% extends "templates/masterTemplate.html" %}
{% import "templates/ui.html" as ui %}
{% block title %}Settings{% endblock %}
{% block javascripts %}
    <script type="text/javascript" src="/javascripts/settings_view.js"></script>
{% endblock %}
{% block content %}
  <div class="onecolumn">
  <span class="tableform">
    <span id="languagesettings">
      <table>
      <tbody>
      <tr>
        <td class="formlabels"><label>Preferred language</label></td>
        <td class="forminputs">
          <select id="language" data-template="#dropdown">
            {% for languageCode, languageName in availableLanguages.iteritems() %}
            <option {% if languageCode == userSettings.preferredLanguage %} selected {% endif %} value="{{ languageCode }}">{{ languageName }}</option>
            {% endfor %}
          </select>
        </td>
      </tr>
      </tbody>
      </table>
    </span>
    <span id="notificationsetting">
      {{ ui.begintable("Notifications", 7) }}
        {{ ui.checkbox("newsletter", userSettings.notifyNewsletter, "Send me a newsletter") }}
      </tr>
      <tr>
        {{ ui.checkbox("emailnotifications", userSettings.notifyEmails, "Send me a email notifications") }}
      </tr>
      <tr class="individualnotifications">
        {{ checkbox("notifystops", userSettings.notifyStopsUsingMyPrivateData, "When someone stops using my private data") }}
      </tr>
      <tr class="individualnotifications">
        {{ ui.checkbox("notifyasks", userSettings.notifyAsksForPrivateData, "When someone asks for my private data") }}
      </tr>
      <tr class="individualnotifications">
        {{ ui.checkbox("notifyaccepts", userSettings.notifyAllowsMePrivateData, "When my request for private data has been accepted") }}
      </tr>
      <tr class="individualnotifications">
        {{ ui.checkbox("notifyrejects", userSettings.notifyDisallowsMePrivateData, "When my request for private data has been rejected") }}
      </tr>
      <tr class="individualnotifications">
        {{ ui.checkbox("notifyrevokes", userSettings.notifyRequestDecision, "When permission to use private data is revoked") }}
      {{ ui.endtable() }}
    </span>
    <span id="notificationsetting">
      {{ ui.begintable("Synchronization", 1) }}
        {{ ui.checkbox("synccarddav", userSettings.cardDAVenabled, "Allow CardDAV psinquing") }}
      {{ ui.endtable() }}
    </span>    
    <span id="carddav" >
      <table id="carddavlogins">
      <tbody>
      {% for login in carddavLogins %}
      <tr class="carddavlogins">
        {% if loop.first -%}
        <td rowspan="{{ carddavLogins|count + 2 }}" class="formlabels" id="carddavlabel"><label>CardDAV devices</label></td>
        {%- endif %} 
        <td class="forminputs">
          <input type="hidden" class="carddavkeys" value="{{ login.key() }}">
          <label class="carddavnames">{{ login.name }}</label>
        </td>
        {{ ui.removebutton("carddav" + loop.index, "carddavremovers") }}
      </tr>
      {% endfor %}
      <tr id="newcarddav">
        {% if carddavLogins|count == 0 %}
        <td rowspan="{{ carddavLogins|count + 2 }}" class="formlabels" id="carddavlabel"><label>CardDAV devices</label></td>
        {% endif %}
        <td class="forminputs">
            <input type="text" id="newcarddavname" value="" placeholder="Type a name for your device">
        </td>
        <td class="forminputs formbuttons">
            <span class="buttons clickable" id="generatecarddav">
              <img src="/images/squareicons/add.png" />
            </span>
        </td>
      </tr>
      <tr class="hiddenelements">
        <td class="forminputs" id="carddavlogin"></td>
        <td class="forminputs formbuttons"></td>
      </tr>
      </tbody>
      </table>
    </span>
    <table>
    <tbody>
      <tr>
        <td class="formlabels"><label>Save changes</label></td>
        <td class="forminputs formbuttons">
          <span class="buttons clickable" id="submitbutton">
            <img src="/images/squareicons/save.png" />
          </span>
        </td>
        <td><br style="clear:both;"/></td>
      </tr>
    </tbody>
    </table>
  </span>
  </div>
{% endblock %}