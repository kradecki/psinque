{% extends "templates/masterTemplate.html" %}
{% block title %}My Card{% endblock %}
{% block javascripts %}
    <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
    <!-- <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCbYyXY_nwEorG6uOAMY5nf-3yrKx7Agfg&sensor=false"></script> -->
    <script type="text/javascript" src="/javascripts/myCard_view.js"></script>
    <script type="text/javascript">
        var additionalEmailCounter = {{ additionalEmails|count }};
    </script>
{% endblock %}
{% block content %}
  {% if firstlogin %}
  <p>This is your first login, so please fill up your profile below:</p>
  {% endif %}
  <div id="images">
    <img src="/images/linustorvalds.jpg" />
  </div>
  <div id="mycard">
  <div class="tableform">
    <span id="generalinfo">
    <table>
    <tr>
      <td class="formlabels"><label>Given names</label></td>
      {% for givenName in userProfile.givenNames %}
      <td class="forminputs"><input type="text" id="firstname" value="{{ givenName }}" minlength="2" /></td>
      <td class="forminputs formbuttons"><span id="addgivenname buttons clickable"><img src="/images/squareicons/add.png" /></span></td>
      {% else %}
      <td class="forminputs"><input type="text" id="firstname" value="" minlength="2" /></td>
      <td class="forminputs formbuttons"><span id="addgivenname buttons clickable"><img src="/images/squareicons/add.png" /></span></td>
      {% endfor %}
    </tr>
    </table>
    <table>
    <tbody>
    <tr>
      <td class="formlabels"><label>Family names</label></td>
      {% for familyName in userProfile.familyNames %}
      <td class="forminputs"><input type="text" id="lastname" value="{{ familyName }}" minlength="2" /></td>
      {% else %}
      <td class="forminputs"><input type="text" id="lastname" value="" minlength="2" /></td>
      {% endfor %}
    </tr>
    </tbody>
    </table>
    </span>
    <span id="emails">
      <table id="primaryemailaddress">
      <tbody>
      <tr>
        <td class="formlabels"><label>Primary email</label></td>
        <td class="forminputs">
          <input type="hidden" class="emailkeys" value="{{ primaryEmail.key() }}"/>
          <input type="text" class="emailaddresses" value="{% if primaryEmail.email != "primary@nonexistant.com" %}{{ primaryEmail.email }}{% endif %}" />
        </td>
        <td class="forminputs formextras">
          <select class="typesofemail">
          {% for emailTypeCode, emailTypeName in emailTypes.items() %}
            <option value="{{ emailTypeCode }}" {% if emailTypeCode == primaryEmail.emailType %}selected="selected"{% endif %}>{{ emailTypeName }}</option>
          {% endfor %}
          </select>
        </td>
        <td class="forminputs formbuttons">
          <span id="addemail buttons clickable">
            <img src="/images/squareicons/add.png" />
          </span>
        </td>
      </tr>
      </tbody>
      </table>
      <table id="additionalemailaddresses">
      <tbody>
      {% for email in additionalEmails %}
      <tr>
        {% if loop.first %}
        <td rowspan="{{ additionalEmails|count }}" class="formlabels"><label>Additional emails</label></td>
        {% endif %}
        <td class="forminputs">
          <input type="hidden" class="emailkeys" value="{{ email.key() }}"/>
          <input type="text" class="emailaddresses" value="{{ email.email }}" />
        </td>
        <td class="forminputs formextras">
          <select class="typesofemail">
          {% for emailTypeCode, emailTypeName in emailTypes.items() %}
            <option value="{{ emailTypeCode }}" {% if emailTypeCode == email.emailType %}selected="selected"{% endif %}>{{ emailTypeName }}</option>
          {% endfor %}
          </select>
        </td>
        <td class="forminputs formbuttons">
          <span class="emailremovers buttons clickable">
            <img src="/images/squareicons/remove.png" />
          </span>
        </td>
      </tr>
      {% endfor %}
      </tbody>
      </table>
    </span>
    <span>
      <table>
      <tbody>
      <tr>
        <td class="formlabels"><label>Save changes</label></td>
        <td class="forminputs formbuttons">
          <span id="submitbutton buttons clickable">
            <img src="/images/squareicons/save.png" />
          </span>
        </td>
        <td><br style="clear:both;"/></td>
      </tr>
      </tbody>
      </table>
    </span>
<!--    <legend>Physical addresses</legend>
    {% for address in addresses %}
    <p id="address{{ address.nr }}">
    <label>Address:</label>
    <input type="text" name="address{{ address.nr }}" value="{{ address.value.address }}" class="required" />
    <select name="typeofAddress{{ address.nr }}">
    {% for addressTypeCode, addressTypeName in addressTypes.iteritems() %}
        {% if addressTypeCode == address.value.addressType %}
        <option value="{{ addressTypeCode }}" selected="selected">{{ addressTypeName }}</option>
        {% else %}
        <option value="{{ addressTypeCode }}">{{ addressTypeName }}</option>
        {% endif %}
    {% endfor %}
    </select>
    <br />
    <label>Postal code:</label>
    <input type="text" name="postal{{ address.nr }}" value="{{ address.value.postalCode }}" /><br />
    <label>City/town/village:</label>
    <input type="text" name="city{{ address.nr }}" value="{{ address.value.city }}" /><br />

    {% if address.value.location %}
    <span class="hiddenCoordinates">
        <label>Longitude:</label>
        <input type="text" name="long{{ address.nr }}" id="long{{ address.nr }}" value="{{ address.value.location.lon }}" readonly="readonly" /><br />
        <label>Latitude:</label>
        <input type="text" name="lat{{ address.nr }}" id="lat{{ address.nr }}" value="{{ address.value.location.lat }}" readonly="readonly" /><br />
    </span>
    {% endif %}

    <a href="" class="addMap">Find coordinates</a>
    <a href="" class="hideMap">Hide the map</a>
    <a href="" class="showMap">Show the map</a>
    {% if address.nr != 1 %}
        | <a href="" id="remover{{ address.nr }}" class="removers">Remove</a>
    {% endif %}
    </p>
    {% endfor %}
    <p id="addAddress"><a href="">Add address</a></p> -->
<!--     <div id="bottonButton"><input type="button" id="submitButton" value="Apply"/></div> -->
  </div>
  </div>
  <br style="clear:both;"/>
{% endblock %}